<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Classroom Timer</title>

<style>
  body{font-family:Arial;margin:0;padding:20px;background:#f6f8fb}
  .wrap{max-width:1100px;margin:auto}
  .card{background:#fff;padding:14px;border-radius:10px;box-shadow:0 8px 24px rgba(0,0,0,.06)}
  .controls{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px}
  input,button{padding:8px;border-radius:8px;border:1px solid #ddd}
  button{background:#0b66ff;color:#fff;border:0;cursor:pointer}

  .timer{margin-top:20px}
  .bar-frame{background:#eef2f7;border-radius:10px;padding:10px}
  .bar{height:36px;background:#ddd;border-radius:8px;position:relative;overflow:visible}
  .bar-fill{position:absolute;left:0;top:0;height:100%;background:#3b82f6;border-radius:8px}

  /* START / END LABELS */
  .time-label{
    position:absolute;
    top:50%;
    transform:translateY(-50%);
    font-weight:900;
    font-size:14px;
    color:#fff;
    pointer-events:none;
    text-shadow:
      -1px -1px 0 #000,
       1px -1px 0 #000,
      -1px  1px 0 #000,
       1px  1px 0 #000;
    z-index:5;
  }
  .time-start{left:8px}
  .time-end{right:8px}

  /* AGENDA */
  .agenda-item{
    position:absolute;
    top:-32px;
    padding:6px 8px;
    border-radius:6px;
    color:#fff;
    font-size:13px;
    white-space:nowrap;
    cursor:grab;
    z-index:10;
  }
</style>
</head>

<body>
<div class="wrap">
  <div class="card">
    <div class="controls">
      <input id="name" placeholder="Timer name">
      <input id="start" type="time">
      <input id="end" type="time">
      <button onclick="addTimer()">Add Timer</button>
    </div>

    <div id="timers"></div>
  </div>
</div>

<script>
function toMin(t){const[a,b]=t.split(':').map(Number);return a*60+b}
function fmt(t){
  let[h,m]=t.split(':').map(Number)
  const ap=h<12?'AM':'PM'
  h=((h+11)%12)+1
  return `${h}:${String(m).padStart(2,'0')} ${ap}`
}

const timers=[]

function addTimer(){
  timers.push({
    id:Math.random(),
    name:name.value || 'Timer',
    start:start.value,
    end:end.value,
    s:toMin(start.value),
    e:toMin(end.value),
    agenda:[
      {label:'Example', dur:10, color:'#f97316', offset:0}
    ]
  })
  render()
}

function render(){
  timersDiv.innerHTML=''
  timers.forEach(t=>{
    const dur=t.e-t.s
    const el=document.createElement('div')
    el.className='timer'
    el.innerHTML=`
      <b>${t.name}</b><br><br>
      <div class="bar-frame">
        <div class="bar" id="bar-${t.id}">
          <div class="bar-fill" id="fill-${t.id}"></div>

          <!-- START / END LABELS -->
          <div class="time-label time-start">${fmt(t.start)}</div>
          <div class="time-label time-end">${fmt(t.end)}</div>
        </div>
      </div>
    `
    timersDiv.appendChild(el)

    // agenda items
    const bar=el.querySelector('.bar')
    t.agenda.forEach(a=>{
      const w=(a.dur/dur)*100
      const item=document.createElement('div')
      item.className='agenda-item'
      item.style.width=`${w}%`
      item.style.left=`${a.offset}%`
      item.style.background=a.color
      item.textContent=`${a.label} (${a.dur}m)`
      bar.appendChild(item)
    })
  })
}

function update(){
  const now=new Date()
  const nowMin=now.getHours()*60+now.getMinutes()+now.getSeconds()/60
  timers.forEach(t=>{
    const dur=t.e-t.s
    let since=(nowMin-t.s+1440)%1440
    if(since>dur) since=dur
    const pct=(since/dur)*100
    const fill=document.getElementById(`fill-${t.id}`)
    if(fill) fill.style.width=pct+'%'
  })
}

setInterval(update,1000)

const timersDiv=document.getElementById('timers')
</script>
</body>
</html>
